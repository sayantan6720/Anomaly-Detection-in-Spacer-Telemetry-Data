# Anomaly Detection in Spacecraft Telemetry

## Project Overview

This project aims to detect anomalies in spacecraft telemetry data using deep learning techniques, particularly Convolutional Autoencoders (CAE) and Temporal Convolutional Networks (TCN). Anomalies in telemetry data are critical for early fault detection, which helps maintain spacecraft safety, prevent system failures, and enhance operational efficiency.

**Team Members:**  
- Sayantan Datta
- Tenzin Kunsang  
- Ankur Baliga  

**Course:** DS 5230  
**Date:** April 24, 2024  

## Problem Statement

The project addresses the challenge of identifying anomalies in time-series data generated by various spacecraft systems, including bus voltage, bus current, reaction wheel temperature, battery temperature, and reaction wheel RPM. Early detection of such anomalies can prevent mission-critical failures in spacecraft.

## Dataset Description

The dataset consists of telemetry data from various spacecraft systems, captured at regular intervals over several years. Below are the key datasets used:

- **Bus Voltage (V):** Voltage levels across the spacecraft's electrical system.
- **Total Spacecraft Bus Current (A):** Current readings from the spacecraft's electrical bus.
- **Reaction Wheel Temperature (°C):** Temperature data from the spacecraft's navigation wheels.
- **Battery Temperature (°C):** Battery unit temperature readings.
- **Reaction Wheel RPM:** Speed of the reaction wheels, crucial for spacecraft orientation.

## Data Preprocessing

1. **Null Value Removal:** Missing data points were identified and removed.
2. **Downsampling:** Time-series data were downsampled to improve computational efficiency.
   - Bus voltage and bus current were downsampled from 5-minute intervals to 8-hour intervals.
   - Reaction wheel and battery temperatures were similarly downsampled.

3. **Data Scaling:** A standard scaler was applied to normalize the data, ensuring each feature contributes proportionally to model training.
4. **Time Steps:** The models use sequences of 150 past data points for prediction, enabling them to capture temporal dependencies in the data.

## Methodology

### 1. **Convolutional Autoencoder (CAE)**

- CAE combines convolutional layers with an autoencoder architecture to extract features from time-series data.
- The model encodes data into a lower-dimensional representation and decodes it to reconstruct the original input.
- **Evaluation Metric:** Mean Squared Error (MSE) was used to calculate the error between predicted and true values.
- **Anomaly Detection:** Data points with errors greater than a calculated threshold were flagged as anomalies.

### 2. **Temporal Convolutional Network (TCN)**

- TCNs are 1-D convolutional networks designed for sequential data, making them suitable for time-series anomaly detection.
- TCNs handle long-range dependencies and ensure causality (future data points are not considered during predictions).
- **Key Hyperparameters:** Kernel size and dilation rate.
  - Kernel size = 1 (since time steps were already incorporated).
  - Dilation rate increased progressively with each layer, enabling the network to capture long-term dependencies.

## Results

### CAE Model Performance:
- **Bus Voltage:** 19.1% anomalies detected with MSE of 0.678.
- **Bus Current:** 13% anomalies detected with MSE of 0.929.
- **Battery Temperature:** 48.95% anomalies detected with MSE of 0.539.
- **Reaction Wheel Temperature:** 24.7% anomalies detected with MSE of 0.603.
- **Reaction Wheel RPM:** 1.2% anomalies detected with MSE of 0.857.

### TCN Model Performance:
- **Bus Voltage:** 6% anomalies detected with MSE of 0.163.
- **Bus Current:** 2% anomalies detected with MSE of 0.191.
- **Battery Temperature:** 8% anomalies detected with MSE of 0.084.
- **Reaction Wheel Temperature:** 10% anomalies detected with MSE of 0.061.
- **Reaction Wheel RPM:** 0.4% anomalies detected with MSE of 0.013.

### Conclusion:
The TCN model significantly outperformed the CAE model, achieving lower MSE values and detecting anomalies more effectively across all datasets.

## Limitations

- **Inherent Dependencies in Time Series:** Most machine learning models assume data independence, making time-series analysis more challenging.
- **Unsupervised Learning:** The lack of labeled data in the anomaly detection task limits the ability to validate the model's accuracy.
- **Unique Domain:** Spacecraft telemetry presents unique challenges, and there are few open-source pre-trained models for this data type.

## How to Run the Project

1. Clone the repository:
    ```bash
    git clone https://github.com/tenzin-kunsang648/FinalProject_DS5230_Spring24.git
    ```
2. Install the required dependencies:
    ```bash
    pip install -r requirements.txt
    ```
3. Preprocess the data:
    ```bash
    python preprocess.py
    ```
4. Train the models:
    ```bash
    python train.py --model [CAE/TCN]
    ```
5. Evaluate the models:
    ```bash
    python evaluate.py --model [CAE/TCN]
    ```

## References

- [Autoencoders in Deep Learning](https://doi.org/10.3390/math11081777)
- [Dilated Convolutions in TCNs](https://www.geeksforgeeks.org/dilated-convolution/)
- [Anomaly Detection in Spacecraft Telemetry](https://aws.amazon.com/what-is/anomaly-detection/)
- [Temporal Convolutional Networks (TCNs)](https://lukeguerdan.com/blog/2019/intro-to-tcns/)

## Contributors
- **Sayantan Datta**
- **Tenzin Kunsang**
- **Ankur Baliga**



[Link to repo](https://github.com/ankurbaliga8/Anomaly-Detection-with-Convolutional-Autoencoders)

**Last Updated on: April 25th, 2024**
